Originally downloaded and modified from https://github.com/cwalter-at/freemodbus/commit/f16701094ca64df3a0366dde1c186a55976d61e4
